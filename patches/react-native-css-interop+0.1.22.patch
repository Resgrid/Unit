diff --git a/node_modules/react-native-css-interop/dist/runtime/web/api.js b/node_modules/react-native-css-interop/dist/runtime/web/api.js
index 1234567..abcdefg 100644
--- a/node_modules/react-native-css-interop/dist/runtime/web/api.js
+++ b/node_modules/react-native-css-interop/dist/runtime/web/api.js
@@ -40,12 +40,12 @@ const cssInterop = (baseComponent, mapping) => {
             typeof baseComponent === "function" &&
             baseComponent.$$typeof === ForwardRefSymbol) {
             delete props.cssInterop;
-            return baseComponent.render(props, props.ref);
+            return (0, react_1.createElement)(baseComponent, props);
         }
         else if (typeof baseComponent === "function" &&
             !(baseComponent.prototype instanceof react_1.Component)) {
             delete props.cssInterop;
-            return baseComponent(props);
+            return (0, react_1.createElement)(baseComponent, props);
         }
         else {
             return (0, react_1.createElement)(baseComponent, props);
diff --git a/node_modules/react-native-css-interop/dist/runtime/web/color-scheme.js b/node_modules/react-native-css-interop/dist/runtime/web/color-scheme.js
index c8fb1d2..876acd6 100644
--- a/node_modules/react-native-css-interop/dist/runtime/web/color-scheme.js
+++ b/node_modules/react-native-css-interop/dist/runtime/web/color-scheme.js
@@ -7,7 +7,7 @@ const observable_1 = require("../observable");
 const stylesheet_1 = require("./stylesheet");
 let appearance = react_native_1.Appearance;
 let appearanceListener;
-const darkModeFlag = stylesheet_1.StyleSheet.getFlag("darkMode");
+const darkModeFlag = (stylesheet_1.StyleSheet.getFlag("darkMode") || "").trim();
 let darkMode;
 let darkModeValue;
 let initialColor = undefined;
@@ -26,7 +26,7 @@ if (darkModeFlag) {
 else if ("window" in globalThis) {
     const headNode = globalThis.window.document.getElementsByTagName("head")[0];
     new MutationObserver(function (_, observer) {
-        const darkModeFlag = stylesheet_1.StyleSheet.getFlag("darkMode");
+        const darkModeFlag = (stylesheet_1.StyleSheet.getFlag("darkMode") || "").trim();
         if (!darkModeFlag)
             return;
         observer.disconnect();
+        const flags = darkModeFlag.split(" ");
+        darkMode = flags[0];
+        darkModeValue = flags[1];
+        // For "media" mode the browser handles dark mode via CSS media queries;
+        // calling set() would throw, so just return after recording the mode.
+        if (darkMode === "media")
+            return;
+        exports.colorScheme.set(globalThis.window.document.documentElement.classList.contains(darkModeValue)
diff --git a/node_modules/react-native-css-interop/dist/runtime/web/useColorScheme.js b/node_modules/react-native-css-interop/dist/runtime/web/useColorScheme.js
index 8aba5a3..b04b575 100644
--- a/node_modules/react-native-css-interop/dist/runtime/web/useColorScheme.js
+++ b/node_modules/react-native-css-interop/dist/runtime/web/useColorScheme.js
@@ -3,11 +3,23 @@ Object.defineProperty(exports, "__esModule", { value: true });
 exports.useColorScheme = useColorScheme;
 const react_1 = require("react");
 const color_scheme_1 = require("./color-scheme");
+const observable_1 = require("../observable");
 function useColorScheme() {
     const [effect, setEffect] = (0, react_1.useState)(() => ({
         run: () => setEffect((s) => ({ ...s })),
         dependencies: new Set(),
     }));
+    // Clean up stale effects when a new effect object is created to prevent
+    // orphaned effects from accumulating in the observable's effects Set.
+    const prevEffect = (0, react_1.useRef)(null);
+    if (prevEffect.current && prevEffect.current !== effect) {
+        (0, observable_1.cleanupEffect)(prevEffect.current);
+    }
+    prevEffect.current = effect;
+    // Also clean up on unmount
+    (0, react_1.useEffect)(() => {
+        return () => (0, observable_1.cleanupEffect)(effect);
+    }, [effect]);
     return {
         colorScheme: color_scheme_1.colorScheme.get(effect),
         setColorScheme: color_scheme_1.colorScheme.set,
